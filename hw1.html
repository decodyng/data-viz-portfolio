<!DOCTYPE html>
<html lang="en">
<head>
	<title>String Tabulation</title>
	<meta charset="utf-8">
	<meta name="author" content="pixelhint.com">
	<meta name="description" content="Magnetic is a stunning responsive HTML5/CSS3 photography/portfolio website  template"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
	<link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/d3.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <style>
    	.content h2{
    		font-family: "raleway", arial;
    		margin-bottom: 15px;
    	}
/*		.chart rect {
			fill:rgb(178, 152, 216);
		}*/

		.chart text {
			  fill: white;
			  font-family: "raleway-regular", arial;
			  text-anchor: end;
			  font-size: 20px;
			}
		.axis text {
		  font: 14px "raleway-regular", arial;
		  fill: black;
		  
		}
/*		.y text {
			opacity:0.1;
		}
		.y path, .y line {
			opacity: 0.1;
		}*/

		.x path, .x line {
			opacity: 0.5;
		}
		.axis path,
		.axis line {
		  fill: none;
		  stroke: #000;
		  shape-rendering: crispEdges;
		}

		.tooltip {   
			  position: absolute;           
			  text-align: center;           
			  width: 60px;                  
			  height: 28px;                 
			  padding: 2px;             
			  font: 12px sans-serif;        
			  background: black;   
			  border: 0px;    
			  border-radius: 5px;          
			  pointer-events: none;         
			}


    </style>
</head>
<body>

	<header>
		<div class="logo">
			<a href="index.html"><img src="img/logo.png" title="Magnetic" alt="Magnetic"/></a>
		</div><!-- end logo -->

		<!--<div id="menu_icon"></div>
		<nav>
			<ul>
				<li><a href="index.html" class="selected">Home</a></li>
				<li><a href="#">About</a></li>
				<li><a href="#">The Team</a></li>
				<li><a href="#">Journal</a></li>
				<li><a href="contact.html">Contact Us</a></li>
			</ul>
		</nav>end navigation menu -->

		<div> 
			<h5 style="text-align:center; line-height:160%">This site is a repository for projects completed as part of MSAN's Information Visualization course</h5><h6 style="text-align:center">Code available at https://github.com/decodyng/data-viz-portfolio</h6>
		</div>
 
		<div class="footer clearfix">
			<ul class="social clearfix">
				<li><a href="http://decodyng.com/" target="_blank" class="website" data-title="Website"></a></li>
				<li><a href="https://twitter.com/decodyng" target="_blank" class="twitter" data-title="Twitter"></a></li>
				<li><a href="mailto:cody.marie.wild@gmail.com" target="_blank" class="email" data-title="Email"></a></li>
				<li><a href="#" target="_blank" class="mobile" data-title="814.414.7199"></a></li>
				<!--<li><a href="#" class="twitter" data-title="Twitter"></a></li>
				<li><a href="#" class="dribble" data-title="Dribble"></a></li>-->
				<!--<li><a href="#" class="rss" data-title="RSS"></a></li>-->
			</ul><!-- end social -->

			<div class="rights">
				<!--<p>Copyright Â© 2014 magnetic.</p>-->
				<p style="font-size:7px; text-align:center;">Template by <a href="">Pixelhint.com</a></p>
			</div><!-- end rights -->
		</div ><!-- end footer -->
	</header><!-- end header -->

	<section class="main clearfix">

		<section class="top">	
			<div class="wrapper content_header clearfix">
				<div class="work_nav">
							
					<ul class="btn clearfix">
						<li><a href="#" class="previous" data-title="Previous"></a></li>
						<li><a href="index.html" class="grid" data-title="Portfolio"></a></li>
						<li><a href="#" class="next" data-title="Next"></a></li>
					</ul>							
					
				</div><!-- end work_nav -->
				<h1 class="title">Letter Frequency Tabulation</h1>

			</div>		
		</section><!-- end top -->

		<section class="wrapper">
			<div class="content">
				<h2 id="test">If you don't see a plot below, add a query string to the URL (.html?wordsgohere)</h2>
				<h5>This chart displays frequncy within your string through bar height and frequency in English as a whole through color intensity</h5>
				<svg class="chart">	
				</svg>
				<div class="explanation">
				<b>Functionality List</b>
				<ul>
					<li>Modified tick appearance to always display five ticks (C)</li>
					<li>Dynamically colored bars according to overall English frequency of given letter (C)</li>
					<li>Sorted bars in alphabetical order (C) </li>
					<li>Modified tickLength on X axis to make ticks less prominent (C)</li>
					<li>Added tooltip to show value of bars when hovered over (B)</li>
					<li>Faded in axis line, tick labels only when plot area hovered over (A)</li>
				</ul>
				<br>
				<p>This visualization uses two primary means of encoding data: bar length, to encode the letter count within the entered query string, and intensity of bar color, used to encode the frequency of that letter in the English language as a whole. This is meant as a simple but interesting way to examine, for any given string, whether its frequency magnitudes follow the pattern of the language as whole, or else diverge from it. I chose to use a color palette that fades from intense to nearly white becase frequency has no diverging property that would justify the choice of a two-color palette.
				<br>
				<br>
				While the template graph included a default axis line that was highly granular, I made the choice to reduce the Y axis to only 5 tickmarks because the complexity of the data is low, and doesn't necessitate that high degree of granularity. By simplifing the axis, I removed ink and, in general, elements on the page that could distract from the data itself. In a similar vein of simplification, I shortened the tickLength of the x axis ticks, relying on the fact that the letters are already vertically aligned with their corresponding bars, and so viewers will already tend to associate them, and don't need a strong visual cue to supplement that tendency. 
				<br><br> Finally, I chose to dynamically modify the page's header text to allow it to provide a tacit user prompt in the case where the page is loaded without a query string, thus making the visualization more usable for those without a pre-conceived expectation of how to access its functionality.
				</p>
					
				</div>
			</div><!-- end content -->
		</section>
	</section><!-- end main -->
	<script>
				var str = decodeURI(window.location.search); 
				var letterData = new Object(); 
				//check for punctuation/special charac
				for (var i = 0, len = str.length; i < len; i++) {
					let = str[i].toLowerCase();
					if (!((let == ' ') || (let == '?'))){
						if (!(letterData.hasOwnProperty(let))) {
					  		letterData[let] = 0; 
					 	};
					 	letterData[let]++;
					};
					  

				};
				if (str) {
					d3.select('#test').text(str);
				}
				var englishFrequencies = {"a":0.08167, "b":0.01492, "c":0.02782, "d":0.04253, "e":0.12702, "f":0.02228, 
							"g":0.02015, "h":0.06094, "i":0.06966, "j":0.00153, "k":0.00772, "l":0.004025,
							"m":0.02406, "n":0.06749, "o":0.07507, "p":0.01929, "r": 0.05987, "s":0.06237,
							"t":0.09056, "u":0.02758, "v":0.00978, "w":0.02360, "x":0.00150, "y":0.01974, "z":0.00074};
				var data = d3.entries(letterData);
				var letterNames = d3.keys(letterData);
				var margin = {top: 20, right: 30, bottom: 30, left: 40};
				var height = 500 - margin.top - margin.bottom;
				var width = 800 - margin.left - margin.right;
				var barWidth = width/data.length;
				var values = d3.values(letterData);

				var y = d3.scale.linear()
					.domain([0, d3.max(values)])
				    .range([height, 0]);

				var x = d3.scale.ordinal()
				    .domain(letterNames.sort())
				    .rangeBands([0, width]);

				var xAxis = d3.svg.axis()
					    .scale(x)
					    .orient("bottom")
					    .tickSize(3);

				var yAxis = d3.svg.axis()
				    .scale(y)
				    .orient("left")
				    .ticks(5);


				var colorScale = d3.scale.linear()
					.domain(d3.extent(d3.values(englishFrequencies)))
					.range(["#DED0E4", "#662977"]);

				var chart = d3.select(".chart")
				    .attr("width", width + margin.left + margin.right)
				    .attr("height", height + margin.top + margin.bottom)
				    .append("g")
    				.attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    			;


    			var tip = d3.select(".content").append("div")   
					    .attr("class", "tooltip")               
					    .style("opacity", 0);


				var bar = chart.selectAll("g")
				    .data(data)
				  	.enter()
				  	.append("g")
				    	.attr("transform", function(d, i) { return "translate(" + x(d.key) + ", 0)"; });
				
	
				bar.append("rect")
					.attr("y", function(d){return y(d.value);})
				    .attr("height", function(d){return height - y(d.value);})
				    .attr("width", x.rangeBand())
				    .style("fill", function(d){return colorScale(englishFrequencies[d.key]);})
				    .on("mouseover", function(d, i) {      
			            tip.transition()        
			                .duration(200)      
			                .style("opacity", .9);      
			            tip .html("Count: " + d.value)   
			                .style("top", (y(d.value) + 150) + "px")
			                .style("left", (x(d.key) + 280 + margin.left) + "px") ;    
			            })                
			        .on("mouseout", function(d) {       
			            tip.transition()        
			                .duration(500)      
			                .style("opacity", 0);
			            });  
									    
				chart.append("g")
				    .attr("class", "x axis")
				    .attr("transform", "translate(0," + height + ")")
				    .call(xAxis);

				chart.append("g")
			      .attr("class", "y axis")
				  .style("opacity", 0)
			      .call(yAxis);

				
			    yAxElem = chart.select(".y");

			    chart.on("mouseover", function(){
			    	yAxElem.transition()
			    			.duration(700)
			    			.style("opacity", .8);
			    })
			    .on("mouseout", function(){
			    	yAxElem.transition()
			    			.duration(700)
			    			.style("opacity", 0);
			    })

				// bar.append("text")
				//     .attr("x", x.rangeBand()/2)
				//     .attr("y", height - 15)
				//     .attr("dy", ".35em")
				//     .text(function(d) {return d['key'];});
				

				// d3.select(".chart")
				//   .selectAll("div")
				//     .data(d3.entries(letterData))
				//   .enter().append("div")
				//     .style("width", function(d) { return d["value"] * 100 + "px"; })
				//     .text(function(d) { return d["key"]; });
				//console.log(JSON.stringify(letterData));

			</script>
</body>
</html>